# Customer Lifetime Value Prediction and Segmentation

## Objective
The objective of this project is to predict customer lifetime value (CLV) and segment customers based on their lifetime value (LTV). This information will be provided to the marketing team to help optimize campaigns and customer acquisition cost (CPA).

## Introduction
The dataset used in this project is sourced from the UCI Machine Learning Repository. It contains transactional data from a UK-based e-commerce store that primarily sells unique all-occasion gifts. The dataset includes features such as Invoice Number, Stock Code, Product Description, Quantity, Invoice Date, Unit Price, Customer ID, and more.

### What is Customer Lifetime Value (CLV)?
Customer lifetime value (CLV) measures how valuable a customer is to a company over an indefinite time span, rather than just focusing on their first purchase. This metric helps businesses understand a reasonable cost per acquisition. CLV is the total worth of a customer over the entire period of their relationship with the business. Tracking CLV is crucial because it costs less to retain existing customers than to acquire new ones. By increasing the value of existing customers, businesses can drive growth.

### Why is it important to track customer lifetime value?
CLV helps marketers understand the revenue they can expect from one customer throughout the business relationship. The longer a customer continues to purchase from a company, the higher their lifetime value becomes.

## Challenges
Many companies struggle to measure CLV due to segregated teams, inadequate systems, and untargeted marketing efforts.

## Business Context and Model Selection
To create an accurate CLV prediction model, it's essential to understand the business context and customer relationships. Business contexts can generally be classified into two categories:

### Business Context:
1. **Contractual**: In a contractual business, there is a definite time when a customer will churn. This type of relationship is common for subscription-based services like Netflix, Hotstar, and Amazon Prime.
2. **Non-Contractual**: In a non-contractual business, customers may silently stop purchasing without informing the company. This makes CLV calculation more challenging. Retail and e-commerce businesses typically fall under this category.

### Purchase Opportunity Types:
1. **Continuous**: Customers make continuous purchases, such as grocery shopping.
2. **Discrete**: Purchases occur at specific time intervals, such as subscription renewals.

Based on the above contexts, we can select the appropriate method for calculating CLV.

## Purpose of the Research
The purpose of this study is to investigate possible methods to estimate potential revenue (CLV) generated by active customers in a non-contractual, continuous business context. We applied probabilistic models like Pareto-NBD, BG-NBD, MBG-NBD, and Gamma-Gamma to our case study. Additionally, customer segmentation using unsupervised machine learning was performed to provide a tool for strategic planning.

## Project Workflow
The steps involved in this project include:

1. **Data Importing**
2. **Data Cleaning**
3. **Exploratory Data Analysis**
4. **Feature Engineering/Extraction**
5. **Cross Validation**
6. **Building Predictive Models**
7. **LTV-Based Customer Segmentation**
8. **Model Evaluation**
9. **Model Deployment**

## Libraries Used
The following libraries were used in this project:

- **Scikit-learn**: Machine learning and data preprocessing.
- **Lifetimes**: CLV modeling, including BG-NBD and Pareto/NBD models.
- **Plotly, Matplotlib, Seaborn, Altair**: Data visualization libraries.
- **XLRD**: Excel file handling.
- **Streamlit**: Web app framework for deployment.
- **Numpy**: Numerical operations.
- **Pandas**: Data manipulation.
- **Datetime**: Handling date and time data.
- **Math**: Mathematical functions.
- **Warnings**: Warning control in Python.
  ## Model
You can view and download the model from the following link: [Customer Lifetime Value Prediction Model](https://cdac-project-clv.streamlit.app/)
